{"ast":null,"code":"var _jsxFileName = \"/Users/ardisred/Workspace/samples4singles/s4s-frontend/src/components/rate/Rate.js\";\n// Organized\nimport React, { useContext, useEffect, useState, useRef } from \"react\";\nimport Rating from '@material-ui/lab/Rating';\nimport { SampleContext } from \"../sample/SampleProvider\";\nimport AudioPlayer from 'react-h5-audio-player';\nimport { Link } from \"react-router-dom\";\nimport \"./Rate.css\";\nimport WaveSurfer from \"wavesurfer.js\";\nimport 'react-h5-audio-player/lib/styles.css';\nimport { HexColorPicker } from \"react-colorful\";\nimport \"react-colorful/dist/index.css\";\nexport const Rate = () => {\n  const waveformRef = useRef(null);\n  const [rSampleItem, setRSampleValue] = useState(0);\n  const [value, setValue] = useState(null);\n  const [volume, setVolume] = useState(null);\n  const [currentSample, setCurrentSample] = useState({});\n  const [noneLeft, setNoneLeft] = useState(false);\n  const [zeroed, setZeroed] = useState(false);\n  const [itemsLeftToShow, setitemsLeftToShow] = useState([]);\n  const [audio_url, setAudioURL] = useState('https://firebasestorage.googleapis.com/v0/b/selektor-b0fc6.appspot.com/o/Audio%2FKick.wav?alt=media&token=61384403-e6c8-4874-9062-1527d920dfe3');\n  const [color, setColor] = useState(\"#aabbcc\");\n  const [wavesurfCreated, setWavesurfCreated] = useState(false);\n  const [wavesurf, setWavesurf] = useState(false);\n  const {\n    favorites,\n    getUsers,\n    getFavorites,\n    getRandomSample,\n    randomSample,\n    skipped,\n    addRatings,\n    getRatings,\n    ratings,\n    getSkipped,\n    randomSamplesLoaded\n  } = useContext(SampleContext);\n  useEffect(() => {\n    if (waveformRef.current) {\n      setWavesurf(WaveSurfer.create({\n        container: waveformRef.current,\n        cursorColor: \"transparent\",\n        backgroundColor: \"black\",\n        barWidth: 1,\n        fillParent: true\n      }));\n    }\n  }, []);\n  let thisSampleFavorites = ratings.filter(rating => rating.sample.id === sample.id);\n  useEffect(() => {\n    if (wavesurf !== false) {\n      wavesurf.load(currentSample.audio_url);\n    }\n  }, [currentSample]);\n  useEffect(() => {\n    console.log(waveformRef);\n\n    if (wavesurf !== false) {\n      wavesurf.setWaveColor(color);\n      setWavesurfCreated(true);\n    }\n  }, [color]);\n\n  function comparer(otherArray) {\n    return function (current) {\n      return otherArray.filter(function (other) {\n        return other.sample_id == current.id;\n      }).length == 0;\n    };\n  }\n\n  const addSampleRatings = () => {\n    console.log(color);\n\n    if (volume !== null && value != null) {\n      addRatings({\n        sample: currentSample.id,\n        color: color,\n        rating: value,\n        loudness: volume\n      });\n    } else {\n      if (volume === null && value !== null) {\n        alert(\"Please drag the volume slider until the sound is just right\");\n      } else if (value === null && volume !== null) {\n        alert(\"Please rate the sample on a scale from 1-5 stars\");\n      } else if (value === null && volume === null) {\n        alert(\"Please rate the sample on a scale from 1-5 stars and drag the volume slider until the sound is just right\");\n      }\n    }\n  };\n\n  useEffect(() => {\n    getUsers().then(getSkipped).then(getFavorites).then(getRandomSample);\n  }, []);\n  useEffect(() => {\n    if (itemsLeftToShow.length > 0) {\n      setCurrentSample(itemsLeftToShow[rSampleItem]);\n    }\n  }, [rSampleItem, zeroed]);\n  useEffect(() => {\n    if (currentSample !== {}) {\n      setAudioURL(currentSample.audio_url);\n    }\n  }, [currentSample]);\n  useEffect(() => {\n    if (randomSamplesLoaded && itemsLeftToShow.length > 0) {\n      if (rSampleItem < itemsLeftToShow.length - 1) {\n        let increment = rSampleItem + 1;\n        setRSampleValue(increment);\n      } else {\n        setRSampleValue(0);\n        setZeroed(true);\n      }\n\n      setNoneLeft(false);\n    } else if (randomSamplesLoaded && itemsLeftToShow.length === 0) {\n      //data has been loaded from api, filtering done, no items left to show\n      setNoneLeft(true);\n    } else {}\n  }, [itemsLeftToShow, randomSample, randomSamplesLoaded]);\n  useEffect(() => {\n    //Filtrationxs\n    let currentUser = parseInt(localStorage.getItem(\"user_number\"));\n    let thisUserSkipped = skipped.filter(skip => skip.user_id === currentUser);\n\n    if (randomSample.length > 0) {\n      let randomSamplesThatHaveNotBeenSkipped = randomSample.filter(comparer(thisUserSkipped));\n      setitemsLeftToShow(randomSamplesThatHaveNotBeenSkipped); //Increment\n    }\n  }, [randomSample, ratings]);\n\n  if (noneLeft !== true) {\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"sampleContainer\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      ref: waveformRef,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"img\", {\n      class: \"img\",\n      src: currentSample.sample_image,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"link_card button4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Link, {\n      to: `/browse/${currentSample.id}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 52\n      }\n    }, currentSample.name)), /*#__PURE__*/React.createElement(Rating, {\n      value: value,\n      onChange: (event, newValue) => {\n        setValue(newValue);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(AudioPlayer, {\n      autoPlayAfterSrcChange: false,\n      src: currentSample.audio_url,\n      onPlay: e => console.log(\"onPlay\"),\n      onVolumeChange: e => setVolume(e.target.volume),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      class: \"button5\",\n      onClick: addSampleRatings,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 21\n      }\n    }, \"Submit Ratings\"), /*#__PURE__*/React.createElement(\"button\", {\n      class: \"button2\",\n      onClick: getRatings,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 21\n      }\n    }, \"Skip\"), /*#__PURE__*/React.createElement(HexColorPicker, {\n      color: color,\n      onChange: setColor,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 21\n      }\n    })));\n  } else {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      class: \"sampleCard\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      ref: waveformRef,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 17\n      }\n    }));\n  }\n};","map":{"version":3,"sources":["/Users/ardisred/Workspace/samples4singles/s4s-frontend/src/components/rate/Rate.js"],"names":["React","useContext","useEffect","useState","useRef","Rating","SampleContext","AudioPlayer","Link","WaveSurfer","HexColorPicker","Rate","waveformRef","rSampleItem","setRSampleValue","value","setValue","volume","setVolume","currentSample","setCurrentSample","noneLeft","setNoneLeft","zeroed","setZeroed","itemsLeftToShow","setitemsLeftToShow","audio_url","setAudioURL","color","setColor","wavesurfCreated","setWavesurfCreated","wavesurf","setWavesurf","favorites","getUsers","getFavorites","getRandomSample","randomSample","skipped","addRatings","getRatings","ratings","getSkipped","randomSamplesLoaded","current","create","container","cursorColor","backgroundColor","barWidth","fillParent","thisSampleFavorites","filter","rating","sample","id","load","console","log","setWaveColor","comparer","otherArray","other","sample_id","length","addSampleRatings","loudness","alert","then","increment","currentUser","parseInt","localStorage","getItem","thisUserSkipped","skip","user_id","randomSamplesThatHaveNotBeenSkipped","sample_image","name","event","newValue","e","target"],"mappings":"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","sourcesContent":["// Organized\nimport React, { useContext, useEffect, useState, useRef } from \"react\"\nimport Rating from '@material-ui/lab/Rating';\nimport { SampleContext } from \"../sample/SampleProvider\"\nimport AudioPlayer from 'react-h5-audio-player'\nimport { Link } from \"react-router-dom\"\nimport \"./Rate.css\"\nimport WaveSurfer from \"wavesurfer.js\";\nimport 'react-h5-audio-player/lib/styles.css'\nimport { HexColorPicker } from \"react-colorful\";\nimport \"react-colorful/dist/index.css\";\n\nexport const Rate = () => {\n\n    const waveformRef = useRef(null);\n\n    const [rSampleItem, setRSampleValue] = useState(0)\n    const [value, setValue] = useState(null)\n    const [volume, setVolume] = useState(null)\n    const [currentSample, setCurrentSample] = useState({})\n    const [noneLeft, setNoneLeft] = useState(false)\n    const [zeroed, setZeroed] = useState(false)\n    const [itemsLeftToShow, setitemsLeftToShow] = useState([])\n    const [audio_url, setAudioURL] = useState('https://firebasestorage.googleapis.com/v0/b/selektor-b0fc6.appspot.com/o/Audio%2FKick.wav?alt=media&token=61384403-e6c8-4874-9062-1527d920dfe3')\n    const [color, setColor] = useState(\"#aabbcc\")\n    const [wavesurfCreated, setWavesurfCreated] = useState(false)\n    const [wavesurf, setWavesurf] = useState(false)\n\n    const { favorites,\n        getUsers,\n        getFavorites,\n        getRandomSample,\n        randomSample,\n        skipped,\n        addRatings,\n        getRatings,\n        ratings,\n        getSkipped,\n        randomSamplesLoaded,\n    } = useContext(SampleContext)\n\n    useEffect(() => {\n        if (waveformRef.current) {\n            setWavesurf(WaveSurfer.create({\n                container: waveformRef.current,\n                cursorColor: \"transparent\",\n                backgroundColor: \"black\",\n                barWidth: 1,\n                fillParent: true\n            }))\n        }\n    }, [])\n    let thisSampleFavorites = ratings.filter(rating => rating.sample.id === sample.id)\n    useEffect(() => {\n        if (wavesurf !== false) {\n            wavesurf.load(currentSample.audio_url)\n        }\n    }, [currentSample])\n\n    useEffect(() => {\n        console.log(waveformRef)\n        if (wavesurf !== false) {\n            wavesurf.setWaveColor(color)\n            setWavesurfCreated(true)\n        }\n    }, [color])\n\n    function comparer(otherArray) {\n        return function (current) {\n            return otherArray.filter(function (other) {\n                return other.sample_id == current.id\n            }).length == 0\n        }\n    }\n\n    const addSampleRatings = () => {\n        console.log(color)\n        if (volume !== null && value != null) {\n            addRatings({\n                sample: currentSample.id,\n                color: color,\n                rating: value,\n                loudness: volume\n            })\n        }\n        else {\n            if (volume === null && value !== null) { alert(\"Please drag the volume slider until the sound is just right\") }\n            else if (value === null && volume !== null) { alert(\"Please rate the sample on a scale from 1-5 stars\") }\n            else if (value === null && volume === null) { alert(\"Please rate the sample on a scale from 1-5 stars and drag the volume slider until the sound is just right\") }\n        }\n    }\n\n    useEffect(() => {\n        getUsers().then(getSkipped).then(getFavorites).then(getRandomSample)\n    }, [])\n\n    useEffect(() => {\n        if (itemsLeftToShow.length > 0) {\n            setCurrentSample(itemsLeftToShow[rSampleItem])\n        }\n    }, [rSampleItem, zeroed])\n\n    useEffect(() => {\n        if (currentSample !== {}) {\n            setAudioURL(currentSample.audio_url)\n        }\n    }, [currentSample])\n\n\n    useEffect(() => {\n        if (randomSamplesLoaded && itemsLeftToShow.length > 0) {\n            if (rSampleItem < itemsLeftToShow.length - 1) {\n                let increment = rSampleItem + 1\n                setRSampleValue(increment)\n            } else {\n                setRSampleValue(0)\n                setZeroed(true)\n            }\n            setNoneLeft(false)\n        }\n        else if (randomSamplesLoaded && itemsLeftToShow.length === 0) {\n            //data has been loaded from api, filtering done, no items left to show\n            setNoneLeft(true)\n        }\n        else {\n\n        }\n    }, [itemsLeftToShow, randomSample, randomSamplesLoaded])\n\n    useEffect(() => {\n\n        //Filtrationxs\n        let currentUser = parseInt(localStorage.getItem(\"user_number\"))\n        let thisUserSkipped = skipped.filter(skip => skip.user_id === currentUser)\n        if (randomSample.length > 0) {\n            let randomSamplesThatHaveNotBeenSkipped = randomSample.filter(comparer(thisUserSkipped))\n            setitemsLeftToShow(randomSamplesThatHaveNotBeenSkipped)\n            //Increment\n        }\n    }, [randomSample, ratings])\n\n    if (noneLeft !== true) {\n        return (\n            <>\n            <div class=\"sampleContainer\">\n            <div ref={waveformRef} />\n                    <img class=\"img\" src={currentSample.sample_image}></img>\n                    <div class=\"link_card button4\"><Link to={`/browse/${currentSample.id}`}>{currentSample.name}</Link></div>\n                    <Rating\n                        value={value}\n                        onChange={(event, newValue) => { setValue(newValue) }} />\n                    <AudioPlayer\n                        autoPlayAfterSrcChange={false}\n                        src={currentSample.audio_url}\n                        onPlay={e => console.log(\"onPlay\")}\n                        onVolumeChange={e => setVolume(e.target.volume)} />\n                    <button class=\"button5\" onClick={addSampleRatings}>Submit Ratings</button>\n                    <button class=\"button2\" onClick={getRatings}>Skip</button>\n                    <HexColorPicker color={color} onChange={setColor} />\n                </div>\n            </>\n        )\n    }\n    else {\n        return (\n            <div class=\"sampleCard\">\n                <div ref={waveformRef} />\n            </div>\n        )\n    }\n\n}"]},"metadata":{},"sourceType":"module"}