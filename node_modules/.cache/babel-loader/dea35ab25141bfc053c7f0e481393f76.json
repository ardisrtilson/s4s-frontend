{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst react_1 = __importStar(require(\"react\"));\n\nconst prop_types_1 = __importDefault(require(\"prop-types\"));\n\nconst wavesurfer_js_1 = __importDefault(require(\"wavesurfer.js\"));\n\nconst helpers_1 = require(\"./helpers\");\n\nconst wavesurferParams = new Set([\"audioContext\", \"audioRate\", \"audioScriptProcessor\", \"autoCenter\", \"autoCenterRate\", \"autoCenterImmediately\", \"backend\", \"backgroundColor\", \"barHeight\", \"barRadius\", \"barGap\", \"barWidth\", \"barMinHeight\", \"closeAudioContext\", \"cursorColor\", \"cursorWidth\", \"drawingContextAttributes\", \"duration\", \"fillParent\", \"forceDecode\", \"height\", \"hideScrollbar\", \"interact\", \"loopSelection\", \"maxCanvasWidth\", \"mediaControls\", \"mediaType\", \"minPxPerSec\", \"normalize\", \"partialRender\", \"pixelRatio\", \"plugins\", \"progressColor\", \"removeMediaElementOnDestroy\", \"renderer\", \"responsive\", \"rtl\", \"scrollParent\", \"skipLength\", \"splitChannels\", \"waveColor\", \"xhr\"]);\nconst EVENTS = [\"audioprocess\", \"error\", \"finish\", \"loading\", \"mouseup\", \"pause\", \"play\", \"ready\", \"scroll\", \"seek\", \"zoom\"];\n/**\n * Throws an error if the prop is defined and not an integer or not positive\n */\n\nfunction positiveIntegerProptype(props, propName, componentName) {\n  const n = props[propName];\n\n  if (n !== undefined && (typeof n !== \"number\" || typeof n === \"string\" && n !== parseInt(n, 10) || n < 0)) {\n    return new Error(`Invalid ${propName} supplied to ${componentName},\n      expected a positive integer`);\n  }\n\n  return null;\n}\n\nconst resizeThrottler = fn => () => {\n  let resizeTimeout;\n\n  if (!resizeTimeout) {\n    // @TODO: Throttle raf\n    resizeTimeout = requestAnimationFrame(() => {\n      resizeTimeout = null;\n      fn();\n    });\n  }\n};\n\nclass WavesurferComponent extends react_1.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isReady: false,\n      pos: 0,\n      formattedPos: 0\n    };\n\n    if (typeof wavesurfer_js_1.default === undefined) {\n      throw new Error(\"WaveSurfer is undefined!\");\n    }\n\n    this.loadMediaElt = this.loadMediaElt.bind(this);\n    this.loadAudio = this.loadAudio.bind(this);\n    this.seekTo = this.seekTo.bind(this);\n\n    if (this.props.responsive) {\n      this.handleResize = resizeThrottler(() => {\n        if (!this.wavesurfer) throw new Error(\"wavesurfer no defined\"); // pause playback for resize operation\n\n        if (this.props.playing) {\n          this.wavesurfer.pause();\n        } // resize the waveform\n\n\n        this.wavesurfer.drawBuffer(); // We allow resize before file isloaded, since we can get wave data from outside,\n        // so there might not be a file loaded when resizing\n\n        if (this.state.isReady) {\n          // restore previous position\n          this.seekTo(this.props.pos);\n        } // restore playback\n\n\n        if (this.props.playing) {\n          this.wavesurfer.play();\n        }\n      });\n    }\n  }\n\n  componentDidMount() {\n    if (!this.wavesurferElm) throw new Error(\"Conainer not defined\");\n    const wavesurferProps = Object.fromEntries(Object.entries(this.props).filter(([key]) => wavesurferParams.has(key)));\n    const options = { ...wavesurferProps,\n      container: this.wavesurferElm\n    };\n    this.wavesurfer = wavesurfer_js_1.default.create(options); // media element loading is only supported by MediaElement backend\n\n    if (this.props.mediaElt) {\n      options.backend = \"MediaElement\";\n    } // file was loaded, wave was drawn\n\n\n    this.wavesurfer.on(\"ready\", () => {\n      if (!this.wavesurfer) throw new Error(\"wavesurfer not initialized\");\n      this.setState({\n        isReady: true,\n        pos: this.props.pos\n      }); // set initial position\n\n      if (this.props.pos) {\n        this.seekTo(this.props.pos);\n      } // set initial volume\n\n\n      if (this.props.volume) {\n        this.wavesurfer.setVolume(this.props.volume);\n      } // set initial playing state\n\n\n      if (this.props.playing) {\n        this.wavesurfer.play();\n      } // set initial zoom\n\n\n      if (this.props.zoom) {\n        this.wavesurfer.zoom(this.props.zoom);\n      }\n    });\n    this.wavesurfer.on(\"audioprocess\", pos => {\n      this.setState({\n        pos\n      });\n\n      if (this.props.onPositionChange) {\n        this.props.onPositionChange({\n          wavesurfer: this.wavesurfer,\n          originalArgs: [pos]\n        });\n      }\n    }); // `audioprocess` is not fired when seeking, so we have to plug into the\n    // `seek` event and calculate the equivalent in seconds (seek event\n    // receives a position float 0-1) – See the README.md for explanation why we\n    // need this\n\n    this.wavesurfer.on(\"seek\", pos => {\n      if (this.state.isReady && this.props.onPositionChange) {\n        const formattedPos = this.posToSec(pos);\n        this.setState({\n          formattedPos\n        });\n        this.props.onPositionChange({\n          wavesurfer: this.wavesurfer,\n          originalArgs: [formattedPos]\n        });\n      }\n    }); // hook up events to callback handlers passed in as props\n\n    EVENTS.forEach(e => {\n      const {\n        wavesurfer\n      } = this;\n      const propCallback = this.props[`on${helpers_1.capitaliseFirstLetter(e)}`];\n\n      if (propCallback) {\n        if (!this.wavesurfer) throw new Error(\"wavesurfer not initialized\");\n        this.wavesurfer.on(e, (...originalArgs) => {\n          propCallback({\n            wavesurfer,\n            originalArgs\n          });\n        });\n      }\n    }); // if audioFile prop, load file\n\n    if (this.props.src) {\n      this.loadAudio(this.props.src, this.props.audioPeaks);\n    } // if mediaElt prop, load media Element\n\n\n    if (this.props.mediaElt) {\n      this.loadMediaElt(this.props.mediaElt, this.props.audioPeaks);\n    }\n\n    if (this.props.responsive && this.handleResize) {\n      window.addEventListener(\"resize\", this.handleResize, false);\n    }\n  } // update wavesurfer rendering manually\n\n\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    if (!this.wavesurfer) throw new Error(\"wavesurfer not initialized\");\n    let newSource = false;\n    let seekToInNewFile; // update audioFile\n\n    if (this.props.src !== nextProps.src) {\n      this.setState({\n        isReady: false\n      });\n      this.loadAudio(nextProps.src, nextProps.audioPeaks);\n      newSource = true;\n    } // update mediaElt\n\n\n    if (nextProps.mediaElt && this.props.mediaElt !== nextProps.mediaElt) {\n      this.setState({\n        isReady: false\n      });\n      this.loadMediaElt(nextProps.mediaElt, nextProps.audioPeaks);\n      newSource = true;\n    } // update peaks\n\n\n    if (this.props.audioPeaks !== nextProps.audioPeaks) {\n      if (nextProps.mediaElt) {\n        this.loadMediaElt(nextProps.mediaElt, nextProps.audioPeaks);\n      } else {\n        this.loadAudio(nextProps.src, nextProps.audioPeaks);\n      }\n    } // update position\n\n\n    if (nextProps.pos !== undefined && this.state.isReady && nextProps.pos !== this.props.pos && nextProps.pos !== this.state.pos) {\n      if (newSource) {\n        seekToInNewFile = this.wavesurfer.on(\"ready\", () => {\n          this.seekTo(nextProps.pos);\n          seekToInNewFile.un();\n        });\n      } else {\n        this.seekTo(nextProps.pos);\n      }\n    } // update playing state\n\n\n    if (!newSource && (this.props.playing !== nextProps.playing || this.wavesurfer.isPlaying() !== nextProps.playing)) {\n      if (nextProps.playing) {\n        this.wavesurfer.play();\n      } else {\n        this.wavesurfer.pause();\n      }\n    } // update volume\n\n\n    if (nextProps.volume && this.props.volume !== nextProps.volume) {\n      this.wavesurfer.setVolume(nextProps.volume);\n    } // update zoom\n\n\n    if (this.props.zoom !== nextProps.zoom) {\n      this.wavesurfer.zoom(nextProps.zoom);\n    } // update audioRate\n\n\n    if (nextProps.audioRate && this.props.audioRate !== nextProps.audioRate) {\n      this.wavesurfer.setPlaybackRate(nextProps.audioRate);\n    } // update backgroundColor\n\n\n    if (nextProps.backgroundColor && this.props.backgroundColor !== nextProps.backgroundColor) {\n      this.wavesurfer.setBackgroundColor(nextProps.backgroundColor);\n    } // update waveColor\n\n\n    if (nextProps.waveColor && this.props.waveColor !== nextProps.waveColor) {\n      this.wavesurfer.setWaveColor(nextProps.waveColor);\n    } // update progressColor\n\n\n    if (nextProps.progressColor && this.props.progressColor !== nextProps.progressColor) {\n      this.wavesurfer.setProgressColor(nextProps.progressColor);\n    }\n\n    if (nextProps.cursorColor && this.props.cursorColor !== nextProps.cursorColor) {\n      this.wavesurfer.setCursorColor(nextProps.cursorColor);\n    }\n\n    if (nextProps.height && this.props.height !== nextProps.height) {\n      this.wavesurfer.setHeight(nextProps.height);\n    } // turn responsive on\n\n\n    if (nextProps.responsive && this.props.responsive !== nextProps.responsive && this.handleResize) {\n      window.addEventListener(\"resize\", this.handleResize, false);\n    } // turn responsive off\n\n\n    if (!nextProps.responsive && this.props.responsive !== nextProps.responsive && this.handleResize) {\n      window.removeEventListener(\"resize\", this.handleResize);\n    }\n  }\n\n  componentWillUnmount() {\n    if (!this.wavesurfer) throw new Error(\"wavesurfer not initialized\"); // remove all listeners\n    // @ts-ignore TS defs are wrong\n\n    EVENTS.forEach(e => this.wavesurfer.un(e)); // destroy wavesurfer instance\n\n    this.wavesurfer.destroy();\n\n    if (this.props.responsive && this.handleResize) {\n      window.removeEventListener(\"resize\", this.handleResize);\n    }\n  } // receives seconds and transforms this to the position as a float 0-1\n\n\n  secToPos(sec) {\n    if (!this.wavesurfer) throw new Error(\"wavesurfer not initialized\");\n    return 1 / this.wavesurfer.getDuration() * sec;\n  } // receives position as a float 0-1 and transforms this to seconds\n\n\n  posToSec(pos) {\n    if (!this.wavesurfer) throw new Error(\"wavesurfer not initialized\");\n    return pos * this.wavesurfer.getDuration();\n  } // pos is in seconds, the 0-1 proportional position we calculate here …\n\n\n  seekTo(sec) {\n    if (!this.wavesurfer) throw new Error(\"wavesurfer not initialized\");\n    const pos = this.secToPos(sec);\n\n    if (this.props.autoCenter) {\n      this.wavesurfer.seekAndCenter(pos);\n    } else {\n      this.wavesurfer.seekTo(pos);\n    }\n  } // load a media element selector or HTML element\n  // if selector, get the HTML element for it\n  // and pass to _loadAudio\n\n\n  loadMediaElt(selectorOrElt, audioPeaks) {\n    if (selectorOrElt instanceof window.HTMLElement) {\n      this.loadAudio(selectorOrElt, audioPeaks);\n    } else {\n      const elm = document.querySelector(selectorOrElt);\n\n      if (!elm) {\n        throw new Error(\"Media Element not found!\");\n      }\n\n      this.loadAudio(elm, audioPeaks);\n    }\n  } // pass audio data to wavesurfer\n\n\n  loadAudio(audioFileOrElt, audioPeaks) {\n    if (!this.wavesurfer) throw new Error(\"wavesurfer not initialized\");\n\n    if (audioFileOrElt instanceof window.HTMLElement) {\n      // media element\n      this.wavesurfer.loadMediaElement(audioFileOrElt, audioPeaks);\n    } else if (typeof audioFileOrElt === \"string\") {\n      // bog-standard string is handled by load method and ajax call\n      this.wavesurfer.load(audioFileOrElt, audioPeaks);\n    } else if (audioFileOrElt instanceof window.Blob) {\n      // blob or file is loaded with loadBlob method\n      this.wavesurfer.loadBlob(audioFileOrElt);\n    } else {\n      throw new Error(`Wavesurfer.loadAudio expects prop audioFile\n        to be either HTMLElement, string or file/blob`);\n    }\n  }\n\n  render() {\n    const childrenWithProps = this.props.children ? react_1.default.Children.map(this.props.children, child => react_1.default.cloneElement(child, {\n      wavesurfer: this.wavesurfer,\n      isReady: this.state.isReady\n    })) : false;\n    return react_1.default.createElement(\"div\", null, react_1.default.createElement(\"div\", {\n      ref: c => {\n        this.wavesurferElm = c || undefined;\n      }\n    }), childrenWithProps);\n  }\n\n}\n\nexports.default = WavesurferComponent;\nWavesurferComponent.defaultProps = {\n  playing: false,\n  pos: 0,\n  responsive: true,\n  autoCenter: true,\n  onPositionChange: () => {}\n};\nWavesurferComponent.propTypes = {\n  playing: prop_types_1.default.bool,\n  pos: prop_types_1.default.number,\n  src: (props, propName, componentName) => {\n    const prop = props[propName];\n\n    if (prop && typeof prop !== \"string\" && !(prop instanceof window.Blob) && !(prop instanceof window.File)) {\n      return new Error(`Invalid ${propName} supplied to ${componentName}\n          expected either string or file/blob`);\n    }\n\n    return null;\n  },\n  mediaElt: prop_types_1.default.oneOfType([prop_types_1.default.string, prop_types_1.default.instanceOf(window.HTMLElement)]),\n  audioPeaks: prop_types_1.default.array,\n  volume: prop_types_1.default.number,\n  zoom: prop_types_1.default.number,\n  responsive: prop_types_1.default.bool,\n  onPositionChange: prop_types_1.default.func,\n  children: prop_types_1.default.oneOfType([prop_types_1.default.element, prop_types_1.default.array]),\n  audioRate: prop_types_1.default.number,\n  backend: prop_types_1.default.oneOf([\"WebAudio\", \"MediaElement\"]),\n  barWidth: (props, propName, componentName) => {\n    const prop = props[propName];\n\n    if (prop !== undefined && typeof prop !== \"number\") {\n      return new Error(`Invalid ${propName} supplied to ${componentName}\n          expected either undefined or number`);\n    }\n\n    return null;\n  },\n  cursorColor: prop_types_1.default.string,\n  // @ts-ignore\n  cursorWidth: positiveIntegerProptype,\n  dragSelection: prop_types_1.default.bool,\n  fillParent: prop_types_1.default.bool,\n  // @ts-ignore\n  height: positiveIntegerProptype,\n  hideScrollbar: prop_types_1.default.bool,\n  interact: prop_types_1.default.bool,\n  loopSelection: prop_types_1.default.bool,\n  mediaControls: prop_types_1.default.bool,\n  // @ts-ignore\n  minPxPerSec: positiveIntegerProptype,\n  normalize: prop_types_1.default.bool,\n  pixelRatio: prop_types_1.default.number,\n  progressColor: prop_types_1.default.string,\n  scrollParent: prop_types_1.default.bool,\n  skipLength: prop_types_1.default.number,\n  waveColor: prop_types_1.default.oneOfType([prop_types_1.default.string, prop_types_1.default.instanceOf(window.CanvasGradient)]),\n  autoCenter: prop_types_1.default.bool\n};","map":{"version":3,"sources":["../src/index.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importStar(require(\"react\"));\nconst prop_types_1 = __importDefault(require(\"prop-types\"));\nconst wavesurfer_js_1 = __importDefault(require(\"wavesurfer.js\"));\nconst helpers_1 = require(\"./helpers\");\nconst wavesurferParams = new Set([\n    \"audioContext\",\n    \"audioRate\",\n    \"audioScriptProcessor\",\n    \"autoCenter\",\n    \"autoCenterRate\",\n    \"autoCenterImmediately\",\n    \"backend\",\n    \"backgroundColor\",\n    \"barHeight\",\n    \"barRadius\",\n    \"barGap\",\n    \"barWidth\",\n    \"barMinHeight\",\n    \"closeAudioContext\",\n    \"cursorColor\",\n    \"cursorWidth\",\n    \"drawingContextAttributes\",\n    \"duration\",\n    \"fillParent\",\n    \"forceDecode\",\n    \"height\",\n    \"hideScrollbar\",\n    \"interact\",\n    \"loopSelection\",\n    \"maxCanvasWidth\",\n    \"mediaControls\",\n    \"mediaType\",\n    \"minPxPerSec\",\n    \"normalize\",\n    \"partialRender\",\n    \"pixelRatio\",\n    \"plugins\",\n    \"progressColor\",\n    \"removeMediaElementOnDestroy\",\n    \"renderer\",\n    \"responsive\",\n    \"rtl\",\n    \"scrollParent\",\n    \"skipLength\",\n    \"splitChannels\",\n    \"waveColor\",\n    \"xhr\",\n]);\nconst EVENTS = [\n    \"audioprocess\",\n    \"error\",\n    \"finish\",\n    \"loading\",\n    \"mouseup\",\n    \"pause\",\n    \"play\",\n    \"ready\",\n    \"scroll\",\n    \"seek\",\n    \"zoom\",\n];\n/**\n * Throws an error if the prop is defined and not an integer or not positive\n */\nfunction positiveIntegerProptype(props, propName, componentName) {\n    const n = props[propName];\n    if (n !== undefined &&\n        (typeof n !== \"number\" ||\n            (typeof n === \"string\" && n !== parseInt(n, 10)) ||\n            n < 0)) {\n        return new Error(`Invalid ${propName} supplied to ${componentName},\n      expected a positive integer`);\n    }\n    return null;\n}\nconst resizeThrottler = (fn) => () => {\n    let resizeTimeout;\n    if (!resizeTimeout) {\n        // @TODO: Throttle raf\n        resizeTimeout = requestAnimationFrame(() => {\n            resizeTimeout = null;\n            fn();\n        });\n    }\n};\nclass WavesurferComponent extends react_1.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            isReady: false,\n            pos: 0,\n            formattedPos: 0,\n        };\n        if (typeof wavesurfer_js_1.default === undefined) {\n            throw new Error(\"WaveSurfer is undefined!\");\n        }\n        this.loadMediaElt = this.loadMediaElt.bind(this);\n        this.loadAudio = this.loadAudio.bind(this);\n        this.seekTo = this.seekTo.bind(this);\n        if (this.props.responsive) {\n            this.handleResize = resizeThrottler(() => {\n                if (!this.wavesurfer)\n                    throw new Error(\"wavesurfer no defined\");\n                // pause playback for resize operation\n                if (this.props.playing) {\n                    this.wavesurfer.pause();\n                }\n                // resize the waveform\n                this.wavesurfer.drawBuffer();\n                // We allow resize before file isloaded, since we can get wave data from outside,\n                // so there might not be a file loaded when resizing\n                if (this.state.isReady) {\n                    // restore previous position\n                    this.seekTo(this.props.pos);\n                }\n                // restore playback\n                if (this.props.playing) {\n                    this.wavesurfer.play();\n                }\n            });\n        }\n    }\n    componentDidMount() {\n        if (!this.wavesurferElm)\n            throw new Error(\"Conainer not defined\");\n        const wavesurferProps = Object.fromEntries(Object.entries(this.props).filter(([key]) => wavesurferParams.has(key)));\n        const options = {\n            ...wavesurferProps,\n            container: this.wavesurferElm,\n        };\n        this.wavesurfer = wavesurfer_js_1.default.create(options);\n        // media element loading is only supported by MediaElement backend\n        if (this.props.mediaElt) {\n            options.backend = \"MediaElement\";\n        }\n        // file was loaded, wave was drawn\n        this.wavesurfer.on(\"ready\", () => {\n            if (!this.wavesurfer)\n                throw new Error(\"wavesurfer not initialized\");\n            this.setState({\n                isReady: true,\n                pos: this.props.pos,\n            });\n            // set initial position\n            if (this.props.pos) {\n                this.seekTo(this.props.pos);\n            }\n            // set initial volume\n            if (this.props.volume) {\n                this.wavesurfer.setVolume(this.props.volume);\n            }\n            // set initial playing state\n            if (this.props.playing) {\n                this.wavesurfer.play();\n            }\n            // set initial zoom\n            if (this.props.zoom) {\n                this.wavesurfer.zoom(this.props.zoom);\n            }\n        });\n        this.wavesurfer.on(\"audioprocess\", (pos) => {\n            this.setState({\n                pos,\n            });\n            if (this.props.onPositionChange) {\n                this.props.onPositionChange({\n                    wavesurfer: this.wavesurfer,\n                    originalArgs: [pos],\n                });\n            }\n        });\n        // `audioprocess` is not fired when seeking, so we have to plug into the\n        // `seek` event and calculate the equivalent in seconds (seek event\n        // receives a position float 0-1) – See the README.md for explanation why we\n        // need this\n        this.wavesurfer.on(\"seek\", (pos) => {\n            if (this.state.isReady && this.props.onPositionChange) {\n                const formattedPos = this.posToSec(pos);\n                this.setState({\n                    formattedPos,\n                });\n                this.props.onPositionChange({\n                    wavesurfer: this.wavesurfer,\n                    originalArgs: [formattedPos],\n                });\n            }\n        });\n        // hook up events to callback handlers passed in as props\n        EVENTS.forEach((e) => {\n            const { wavesurfer } = this;\n            const propCallback = this.props[`on${helpers_1.capitaliseFirstLetter(e)}`];\n            if (propCallback) {\n                if (!this.wavesurfer)\n                    throw new Error(\"wavesurfer not initialized\");\n                this.wavesurfer.on(e, (...originalArgs) => {\n                    propCallback({\n                        wavesurfer,\n                        originalArgs,\n                    });\n                });\n            }\n        });\n        // if audioFile prop, load file\n        if (this.props.src) {\n            this.loadAudio(this.props.src, this.props.audioPeaks);\n        }\n        // if mediaElt prop, load media Element\n        if (this.props.mediaElt) {\n            this.loadMediaElt(this.props.mediaElt, this.props.audioPeaks);\n        }\n        if (this.props.responsive && this.handleResize) {\n            window.addEventListener(\"resize\", this.handleResize, false);\n        }\n    }\n    // update wavesurfer rendering manually\n    UNSAFE_componentWillReceiveProps(nextProps) {\n        if (!this.wavesurfer)\n            throw new Error(\"wavesurfer not initialized\");\n        let newSource = false;\n        let seekToInNewFile;\n        // update audioFile\n        if (this.props.src !== nextProps.src) {\n            this.setState({\n                isReady: false,\n            });\n            this.loadAudio(nextProps.src, nextProps.audioPeaks);\n            newSource = true;\n        }\n        // update mediaElt\n        if (nextProps.mediaElt && this.props.mediaElt !== nextProps.mediaElt) {\n            this.setState({\n                isReady: false,\n            });\n            this.loadMediaElt(nextProps.mediaElt, nextProps.audioPeaks);\n            newSource = true;\n        }\n        // update peaks\n        if (this.props.audioPeaks !== nextProps.audioPeaks) {\n            if (nextProps.mediaElt) {\n                this.loadMediaElt(nextProps.mediaElt, nextProps.audioPeaks);\n            }\n            else {\n                this.loadAudio(nextProps.src, nextProps.audioPeaks);\n            }\n        }\n        // update position\n        if (nextProps.pos !== undefined &&\n            this.state.isReady &&\n            nextProps.pos !== this.props.pos &&\n            nextProps.pos !== this.state.pos) {\n            if (newSource) {\n                seekToInNewFile = this.wavesurfer.on(\"ready\", () => {\n                    this.seekTo(nextProps.pos);\n                    seekToInNewFile.un();\n                });\n            }\n            else {\n                this.seekTo(nextProps.pos);\n            }\n        }\n        // update playing state\n        if (!newSource &&\n            (this.props.playing !== nextProps.playing ||\n                this.wavesurfer.isPlaying() !== nextProps.playing)) {\n            if (nextProps.playing) {\n                this.wavesurfer.play();\n            }\n            else {\n                this.wavesurfer.pause();\n            }\n        }\n        // update volume\n        if (nextProps.volume && this.props.volume !== nextProps.volume) {\n            this.wavesurfer.setVolume(nextProps.volume);\n        }\n        // update zoom\n        if (this.props.zoom !== nextProps.zoom) {\n            this.wavesurfer.zoom(nextProps.zoom);\n        }\n        // update audioRate\n        if (nextProps.audioRate && this.props.audioRate !== nextProps.audioRate) {\n            this.wavesurfer.setPlaybackRate(nextProps.audioRate);\n        }\n        // update backgroundColor\n        if (nextProps.backgroundColor &&\n            this.props.backgroundColor !== nextProps.backgroundColor) {\n            this.wavesurfer.setBackgroundColor(nextProps.backgroundColor);\n        }\n        // update waveColor\n        if (nextProps.waveColor && this.props.waveColor !== nextProps.waveColor) {\n            this.wavesurfer.setWaveColor(nextProps.waveColor);\n        }\n        // update progressColor\n        if (nextProps.progressColor &&\n            this.props.progressColor !== nextProps.progressColor) {\n            this.wavesurfer.setProgressColor(nextProps.progressColor);\n        }\n        if (nextProps.cursorColor &&\n            this.props.cursorColor !== nextProps.cursorColor) {\n            this.wavesurfer.setCursorColor(nextProps.cursorColor);\n        }\n        if (nextProps.height && this.props.height !== nextProps.height) {\n            this.wavesurfer.setHeight(nextProps.height);\n        }\n        // turn responsive on\n        if (nextProps.responsive &&\n            this.props.responsive !== nextProps.responsive &&\n            this.handleResize) {\n            window.addEventListener(\"resize\", this.handleResize, false);\n        }\n        // turn responsive off\n        if (!nextProps.responsive &&\n            this.props.responsive !== nextProps.responsive &&\n            this.handleResize) {\n            window.removeEventListener(\"resize\", this.handleResize);\n        }\n    }\n    componentWillUnmount() {\n        if (!this.wavesurfer)\n            throw new Error(\"wavesurfer not initialized\");\n        // remove all listeners\n        // @ts-ignore TS defs are wrong\n        EVENTS.forEach((e) => this.wavesurfer.un(e));\n        // destroy wavesurfer instance\n        this.wavesurfer.destroy();\n        if (this.props.responsive && this.handleResize) {\n            window.removeEventListener(\"resize\", this.handleResize);\n        }\n    }\n    // receives seconds and transforms this to the position as a float 0-1\n    secToPos(sec) {\n        if (!this.wavesurfer)\n            throw new Error(\"wavesurfer not initialized\");\n        return (1 / this.wavesurfer.getDuration()) * sec;\n    }\n    // receives position as a float 0-1 and transforms this to seconds\n    posToSec(pos) {\n        if (!this.wavesurfer)\n            throw new Error(\"wavesurfer not initialized\");\n        return pos * this.wavesurfer.getDuration();\n    }\n    // pos is in seconds, the 0-1 proportional position we calculate here …\n    seekTo(sec) {\n        if (!this.wavesurfer)\n            throw new Error(\"wavesurfer not initialized\");\n        const pos = this.secToPos(sec);\n        if (this.props.autoCenter) {\n            this.wavesurfer.seekAndCenter(pos);\n        }\n        else {\n            this.wavesurfer.seekTo(pos);\n        }\n    }\n    // load a media element selector or HTML element\n    // if selector, get the HTML element for it\n    // and pass to _loadAudio\n    loadMediaElt(selectorOrElt, audioPeaks) {\n        if (selectorOrElt instanceof window.HTMLElement) {\n            this.loadAudio(selectorOrElt, audioPeaks);\n        }\n        else {\n            const elm = document.querySelector(selectorOrElt);\n            if (!elm) {\n                throw new Error(\"Media Element not found!\");\n            }\n            this.loadAudio(elm, audioPeaks);\n        }\n    }\n    // pass audio data to wavesurfer\n    loadAudio(audioFileOrElt, audioPeaks) {\n        if (!this.wavesurfer)\n            throw new Error(\"wavesurfer not initialized\");\n        if (audioFileOrElt instanceof window.HTMLElement) {\n            // media element\n            this.wavesurfer.loadMediaElement(audioFileOrElt, audioPeaks);\n        }\n        else if (typeof audioFileOrElt === \"string\") {\n            // bog-standard string is handled by load method and ajax call\n            this.wavesurfer.load(audioFileOrElt, audioPeaks);\n        }\n        else if (audioFileOrElt instanceof window.Blob) {\n            // blob or file is loaded with loadBlob method\n            this.wavesurfer.loadBlob(audioFileOrElt);\n        }\n        else {\n            throw new Error(`Wavesurfer.loadAudio expects prop audioFile\n        to be either HTMLElement, string or file/blob`);\n        }\n    }\n    render() {\n        const childrenWithProps = this.props.children\n            ? react_1.default.Children.map(this.props.children, (child) => react_1.default.cloneElement(child, {\n                wavesurfer: this.wavesurfer,\n                isReady: this.state.isReady,\n            }))\n            : false;\n        return (react_1.default.createElement(\"div\", null,\n            react_1.default.createElement(\"div\", { ref: (c) => {\n                    this.wavesurferElm = c || undefined;\n                } }),\n            childrenWithProps));\n    }\n}\nexports.default = WavesurferComponent;\nWavesurferComponent.defaultProps = {\n    playing: false,\n    pos: 0,\n    responsive: true,\n    autoCenter: true,\n    onPositionChange: () => { },\n};\nWavesurferComponent.propTypes = {\n    playing: prop_types_1.default.bool,\n    pos: prop_types_1.default.number,\n    src: (props, propName, componentName) => {\n        const prop = props[propName];\n        if (prop &&\n            typeof prop !== \"string\" &&\n            !(prop instanceof window.Blob) &&\n            !(prop instanceof window.File)) {\n            return new Error(`Invalid ${propName} supplied to ${componentName}\n          expected either string or file/blob`);\n        }\n        return null;\n    },\n    mediaElt: prop_types_1.default.oneOfType([\n        prop_types_1.default.string,\n        prop_types_1.default.instanceOf(window.HTMLElement),\n    ]),\n    audioPeaks: prop_types_1.default.array,\n    volume: prop_types_1.default.number,\n    zoom: prop_types_1.default.number,\n    responsive: prop_types_1.default.bool,\n    onPositionChange: prop_types_1.default.func,\n    children: prop_types_1.default.oneOfType([prop_types_1.default.element, prop_types_1.default.array]),\n    audioRate: prop_types_1.default.number,\n    backend: prop_types_1.default.oneOf([\"WebAudio\", \"MediaElement\"]),\n    barWidth: (props, propName, componentName) => {\n        const prop = props[propName];\n        if (prop !== undefined && typeof prop !== \"number\") {\n            return new Error(`Invalid ${propName} supplied to ${componentName}\n          expected either undefined or number`);\n        }\n        return null;\n    },\n    cursorColor: prop_types_1.default.string,\n    // @ts-ignore\n    cursorWidth: positiveIntegerProptype,\n    dragSelection: prop_types_1.default.bool,\n    fillParent: prop_types_1.default.bool,\n    // @ts-ignore\n    height: positiveIntegerProptype,\n    hideScrollbar: prop_types_1.default.bool,\n    interact: prop_types_1.default.bool,\n    loopSelection: prop_types_1.default.bool,\n    mediaControls: prop_types_1.default.bool,\n    // @ts-ignore\n    minPxPerSec: positiveIntegerProptype,\n    normalize: prop_types_1.default.bool,\n    pixelRatio: prop_types_1.default.number,\n    progressColor: prop_types_1.default.string,\n    scrollParent: prop_types_1.default.bool,\n    skipLength: prop_types_1.default.number,\n    waveColor: prop_types_1.default.oneOfType([\n        prop_types_1.default.string,\n        prop_types_1.default.instanceOf(window.CanvasGradient),\n    ]),\n    autoCenter: prop_types_1.default.bool,\n};\n//# sourceMappingURL=index.js.map"]},"metadata":{},"sourceType":"script"}