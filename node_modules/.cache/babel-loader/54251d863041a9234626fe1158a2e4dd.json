{"ast":null,"code":"var _jsxFileName = \"/Users/ardisred/Workspace/samples4singles/s4s-frontend/src/components/sample/SampleDetail.js\";\n// Organized\nimport React, { useContext, useEffect, useState, useRef } from \"react\";\nimport { SampleContext } from \"../sample/SampleProvider\";\nimport AudioPlayer from 'react-h5-audio-player';\nimport { Link } from \"react-router-dom\";\nimport \"./Samples.css\";\nimport WaveSurfer from \"wavesurfer.js\";\nimport 'react-h5-audio-player/lib/styles.css';\nimport { HexColorPicker } from \"react-colorful\";\nimport \"react-colorful/dist/index.css\";\nimport TextField from '@material-ui/core/TextField';\nimport Rating from '@material-ui/lab/Rating';\nimport Button from '@material-ui/core/Button';\nimport { Divider, Avatar, Grid, Paper } from \"@material-ui/core\";\nimport firebase from '../../firebase';\nexport const SampleDetails = props => {\n  const [localState, setLocalState] = useState({});\n  const [audio_url, setAudioURL] = useState('https://firebasestorage.googleapis.com/v0/b/selektor-b0fc6.appspot.com/o/Audio%2FKick.wav?alt=media&token=61384403-e6c8-4874-9062-1527d920dfe3');\n  const [color, setColor] = useState(\"#aabbcc\");\n  let db = firebase.firestore();\n  let thingsRef = db.collection('Comments');\n\n  const delete_prompt = id => {\n    var retVal = window.confirm(\"Are you sure you want to delete your comment?\");\n\n    if (retVal == true) {\n      deleteComment(id);\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  const handleControlledInputChange = e => {\n    const newComment = Object.assign({}, localState);\n    newComment[e.target.name] = e.target.value;\n    setLocalState(newComment);\n  };\n\n  const deleteComment = id => {\n    releaseComment(id);\n    getComments();\n    getRatings();\n  };\n\n  const submitComment = () => {\n    addComment({\n      content: localState.content,\n      user: localStorage.getItem(\"user_number\"),\n      date_added: \"4\",\n      sample: props.match.params.sampleId\n    });\n    thingsRef.add({\n      name: name.current.value,\n      uploader: localStorage.getItem(\"user_number\"),\n      audio_url: url,\n      date_added: \"2020-7-7\"\n    });\n    getComments();\n    setLocalState(\"\");\n  };\n\n  const waveformRef = useRef(null);\n  const {\n    getUsers,\n    singleSample,\n    getSampleById,\n    getComments,\n    commentValue,\n    addComment,\n    releaseComment,\n    getRatings,\n    ratings\n  } = useContext(SampleContext);\n  useEffect(() => {\n    waveformRef.current = WaveSurfer.create({\n      container: waveformRef.current,\n      cursorColor: \"transparent\",\n      backgroundColor: \"black\",\n      barWidth: 1,\n      fillParent: true\n    });\n    waveformRef.current.load(audio_url);\n    waveformRef.current.setWaveColor(\"red\");\n  }, []);\n  useEffect(() => {\n    waveformRef.current.setWaveColor(color);\n  }, [color]);\n  useEffect(() => {\n    if (audio_url !== undefined) {\n      waveformRef.current.load(audio_url);\n    }\n  }, [audio_url]);\n  useEffect(() => {\n    let sampleId = parseInt(props.match.params.sampleId);\n    getUsers();\n    getComments().then(res => setLocalState(res));\n    getSampleById(sampleId);\n    let thisSampleRatings = ratings.filter(rating => rating.sample.id === parseInt(props.match.params.sampleId));\n    let averageColor = thisSampleRatings.reduce((total, next) => total + parseInt(next.color.substring(1), 16), 0) / thisSampleRatings.length;\n    let averageColorHex = Math.round(averageColor).toString(16);\n    averageColorHex = `#` + averageColorHex;\n\n    if (averageColorHex === \"#NaN\") {\n      averageColorHex = '#ffffff';\n    }\n\n    setColor(averageColorHex);\n    setAudioURL(singleSample.audio_url);\n  }, []);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    class: \"sampleContainer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    class: \"img\",\n    src: singleSample.sample_image,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    class: \"link_card button4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    to: `/browse/${singleSample.id}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 48\n    }\n  }, singleSample.name)), /*#__PURE__*/React.createElement(\"div\", {\n    ref: waveformRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(AudioPlayer, {\n    autoPlayAfterSrcChange: false,\n    src: singleSample.audio_url,\n    onPlay: e => console.log(\"onPlay\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(TextField, {\n    name: \"content\",\n    onChange: handleControlledInputChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Button, {\n    onClick: () => {\n      submitComment();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 13\n    }\n  }, \"Submit Comment\")), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      padding: 14\n    },\n    className: \"App\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 7\n    }\n  }, \"Comments\"), commentValue.map(comment => {\n    if (comment.sample === parseInt(props.match.params.sampleId)) {\n      return /*#__PURE__*/React.createElement(Paper, {\n        style: {\n          padding: \"40px 20px\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(Grid, {\n        container: true,\n        wrap: \"nowrap\",\n        spacing: 2,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(Grid, {\n        item: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(Avatar, {\n        alt: \"Remy Sharp\",\n        src: comment.user.profile_image,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 13\n        }\n      })), /*#__PURE__*/React.createElement(Grid, {\n        justifyContent: \"left\",\n        item: true,\n        xs: true,\n        zeroMinWidth: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"h4\", {\n        style: {\n          margin: 0,\n          textAlign: \"left\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 13\n        }\n      }, comment.user.user.username), /*#__PURE__*/React.createElement(\"p\", {\n        style: {\n          textAlign: \"left\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 13\n        }\n      }, comment.content), /*#__PURE__*/React.createElement(Button, {\n        onClick: () => {\n          delete_prompt(comment.id);\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 13\n        }\n      }, \"Delete Comment\"), /*#__PURE__*/React.createElement(\"p\", {\n        style: {\n          textAlign: \"left\",\n          color: \"gray\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 13\n        }\n      }, \"posted less than 1 minute ago\"))), /*#__PURE__*/React.createElement(Divider, {\n        variant: \"fullWidth\",\n        style: {\n          margin: \"30px 0\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 9\n        }\n      }));\n    }\n  })));\n};","map":{"version":3,"sources":["/Users/ardisred/Workspace/samples4singles/s4s-frontend/src/components/sample/SampleDetail.js"],"names":["React","useContext","useEffect","useState","useRef","SampleContext","AudioPlayer","Link","WaveSurfer","HexColorPicker","TextField","Rating","Button","Divider","Avatar","Grid","Paper","firebase","SampleDetails","props","localState","setLocalState","audio_url","setAudioURL","color","setColor","db","firestore","thingsRef","collection","delete_prompt","id","retVal","window","confirm","deleteComment","handleControlledInputChange","e","newComment","Object","assign","target","name","value","releaseComment","getComments","getRatings","submitComment","addComment","content","user","localStorage","getItem","date_added","sample","match","params","sampleId","add","current","uploader","url","waveformRef","getUsers","singleSample","getSampleById","commentValue","ratings","create","container","cursorColor","backgroundColor","barWidth","fillParent","load","setWaveColor","undefined","parseInt","then","res","thisSampleRatings","filter","rating","averageColor","reduce","total","next","substring","length","averageColorHex","Math","round","toString","sample_image","console","log","padding","map","comment","profile_image","margin","textAlign","username"],"mappings":"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","sourcesContent":["// Organized\nimport React, { useContext, useEffect, useState, useRef } from \"react\"\nimport { SampleContext } from \"../sample/SampleProvider\"\nimport AudioPlayer from 'react-h5-audio-player'\nimport { Link } from \"react-router-dom\"\nimport \"./Samples.css\"\nimport WaveSurfer from \"wavesurfer.js\";\nimport 'react-h5-audio-player/lib/styles.css'\nimport { HexColorPicker } from \"react-colorful\";\nimport \"react-colorful/dist/index.css\";\nimport TextField from '@material-ui/core/TextField';\nimport Rating from '@material-ui/lab/Rating';\nimport Button from '@material-ui/core/Button';\nimport { Divider, Avatar, Grid, Paper } from \"@material-ui/core\";\nimport firebase from '../../firebase'\n\nexport const SampleDetails = (props) => {\n\n  const [localState, setLocalState] = useState({})\n  const [audio_url, setAudioURL] = useState('https://firebasestorage.googleapis.com/v0/b/selektor-b0fc6.appspot.com/o/Audio%2FKick.wav?alt=media&token=61384403-e6c8-4874-9062-1527d920dfe3')\n  const [color, setColor] = useState(\"#aabbcc\")\n  let db = firebase.firestore();\n  let thingsRef = db.collection('Comments')\n\n  const delete_prompt = (id) => {\n    var retVal = window.confirm(\"Are you sure you want to delete your comment?\");\n    if( retVal == true ) {\n        deleteComment(id)\n        return true;\n    } else {\n        return false;\n    }\n}\n\n  const handleControlledInputChange = (e) => {\n    const newComment = Object.assign({}, localState)\n    newComment[e.target.name] = e.target.value\n    setLocalState(newComment)\n}\n\nconst deleteComment = (id) => {\n  releaseComment(id)\n  getComments()\n  getRatings()\n}\n\nconst submitComment = () => {\n  addComment({\n    content: localState.content,\n    user: localStorage.getItem(\"user_number\"),\n    date_added: \"4\",\n    sample: props.match.params.sampleId\n})\nthingsRef.add({\n  name: name.current.value,\n  uploader: localStorage.getItem(\"user_number\"),\n  audio_url: url,\n  date_added: \"2020-7-7\"\n})\n  getComments()\n  setLocalState(\"\")\n}\n\n  const waveformRef = useRef(null);\n\n    const {\n        getUsers,\n        singleSample,\n        getSampleById,\n        getComments,\n        commentValue,\n        addComment,\n        releaseComment,\n        getRatings,\n        ratings\n    } = useContext(SampleContext)\n\n    useEffect(() => {\n        waveformRef.current = WaveSurfer.create({ \n          container: waveformRef.current,\n          cursorColor: \"transparent\",\n          backgroundColor: \"black\",\n          barWidth: 1,\n          fillParent: true\n        });\n        waveformRef.current.load(audio_url)\n        waveformRef.current.setWaveColor(\"red\")\n      }, [])\n\n      useEffect(() => {\n        waveformRef.current.setWaveColor(color)\n      }, [color])\n\n      useEffect(() => {\n        if (audio_url !== undefined)\n        {\n          waveformRef.current.load(audio_url)\n        }\n      }, [audio_url])\n\n    useEffect(() => {\n        let sampleId = parseInt(props.match.params.sampleId)\n        getUsers()\n        getComments().then(res => setLocalState(res))\n        getSampleById(sampleId)\n        let thisSampleRatings = ratings.filter(rating => rating.sample.id === parseInt(props.match.params.sampleId))\n        let averageColor = thisSampleRatings.reduce((total, next) => total + parseInt(next.color.substring(1), 16), 0) / thisSampleRatings.length;\n                      let averageColorHex = Math.round(averageColor).toString(16)\n                      averageColorHex = `#` + averageColorHex\n                      if(averageColorHex === \"#NaN\"){averageColorHex = '#ffffff'}\n                      setColor(averageColorHex)\n                      setAudioURL(singleSample.audio_url)\n    }, [])\n\n        return (\n            <>\n            <div class=\"sampleContainer\">\n            <img class=\"img\" src={singleSample.sample_image}></img>\n                <div class=\"link_card button4\"><Link to={`/browse/${singleSample.id}`}>{singleSample.name}</Link></div>\n                <div ref={waveformRef} />\n                <AudioPlayer\n                    autoPlayAfterSrcChange={false}\n                    src={singleSample.audio_url}\n                    onPlay={e => console.log(\"onPlay\")}/>\n            <TextField name=\"content\" onChange={handleControlledInputChange}></TextField>\n            <Button onClick={() => {submitComment()}}>Submit Comment</Button>\n            </div>\n            <div style={{ padding: 14 }} className=\"App\">\n      <h1>Comments</h1>\n      {\n      commentValue.map(comment => {\n      if (comment.sample ===parseInt(props.match.params.sampleId)){\n      return(\n      <Paper style={{ padding: \"40px 20px\" }}>\n        <Grid container wrap=\"nowrap\" spacing={2}>\n          <Grid item>\n            <Avatar alt=\"Remy Sharp\" src={comment.user.profile_image} />\n          </Grid>\n          <Grid justifyContent=\"left\" item xs zeroMinWidth>\n            <h4 style={{ margin: 0, textAlign: \"left\" }}>{comment.user.user.username}</h4>\n            <p style={{ textAlign: \"left\" }}>\n              {comment.content}\n            </p>\n            <Button onClick={() => {delete_prompt(comment.id)}}>Delete Comment</Button>\n            <p style={{ textAlign: \"left\", color: \"gray\" }}>\n              posted less than 1 minute ago\n            </p>\n          </Grid>\n        </Grid>\n        <Divider variant=\"fullWidth\" style={{ margin: \"30px 0\" }} />\n      </Paper>\n      )\n      }}\n      )\n\n      }\n    </div>\n            </>\n        )\n}"]},"metadata":{},"sourceType":"module"}